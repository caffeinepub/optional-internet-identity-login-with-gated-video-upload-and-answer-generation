{
  "kind": "build_request",
  "title": "Generate full riddle solutions instead of echoing riddle text",
  "projectName": "Riddle Solver",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Update the backend `generateAnswer(imageClueIds, riddle)` so it produces a full, non-empty solution derived from the provided clue IDs and riddle text, and never returns a response that is just the original riddle text echoed back.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2"
        ],
        "quotes": [
          "the generated answer is still just the riddle",
          "the system should think over the clues and generated a full solution"
        ]
      },
      "acceptanceCriteria": [
        "Given a non-empty `riddle` input, the returned text must not be exactly equal (after trimming) to the input `riddle`.",
        "The returned text must be a 'full solution' format that includes (at minimum) a clear final answer and a short explanation that references the provided `imageClueIds` (e.g., by listing the IDs used).",
        "If the riddle cannot be confidently solved with the available inputs, return a helpful best-effort solution text (e.g., 'Most likely answer: â€¦' plus reasoning and what information is missing) rather than repeating the riddle or returning a generic 'try again' message.",
        "If any provided `imageClueIds` do not exist or are not accessible to the caller, the response must still be helpful and explicitly indicate which clue IDs were unavailable/invalid, while still attempting a solution using the remaining valid clues.",
        "The function must continue to enforce the existing authorization rule (authenticated users only)."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Adjust the frontend answer generation UX copy to reflect that the system generates a full solution (not a restatement), and ensure the UI gracefully displays multi-paragraph solution output from the backend.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2"
        ],
        "quotes": [
          "the system should think over the clues and generated a full solution"
        ]
      },
      "acceptanceCriteria": [
        "The 'Generate Answer' output area correctly displays multi-line text (including blank lines) returned by the backend without truncation.",
        "Any user-facing descriptions in the answer-generation UI that imply 'analyze riddle text' should be updated to explicitly say it generates a 'full solution' (English text).",
        "The existing frontend safeguard that detects an echoed riddle remains compatible (i.e., should not falsely trigger for valid full-solution responses)."
      ]
    }
  ],
  "constraints": [
    "Do not introduce additional backend services or external AI/LLM integrations; implement solution generation logic within the existing single Motoko actor.",
    "Keep all Motoko logic in `backend/main.mo` (single-actor architecture).",
    "Do not modify files under `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, or anything inside `frontend/src/components/ui`; compose existing UI components instead."
  ],
  "nonGoals": [
    "Performing actual image/audio/video content understanding (no OCR, no CV/ML analysis of blobs).",
    "Adding third-party authentication beyond Internet Identity.",
    "Adding real-time messaging or WebSocket-based streaming of generation results."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}